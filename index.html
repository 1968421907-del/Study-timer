<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Study & Break Timer</title>
  <style>
    * { box-sizing: border-box; font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif; }
    body {
      margin: 0; min-height: 100vh; display: flex; align-items: center; justify-content: center;
      transition: background-color 0.8s ease;
    }
    .app {
      background: rgba(255,255,255,0.9); border-radius: 18px; padding: 22px 26px 26px;
      width: 100%; max-width: 420px; box-shadow: 0 20px 40px rgba(0,0,0,0.18); text-align: center;
    }
    h1 { margin: 0 0 6px; font-size: 1.6rem; }
    .phase { font-weight: 600; margin-bottom: 10px; }
    .timer { font-size: 3rem; font-weight: 800; margin: 8px 0 16px; }
    .section { margin-bottom: 16px; }
    .section-title { font-weight: 600; margin-bottom: 8px; }
    .buttons { display: grid; grid-template-columns: repeat(auto-fit, minmax(64px, 1fr)); gap: 8px; }
    button {
      padding: 10px 6px; border: none; border-radius: 10px; background: #222; color: #fff;
      cursor: pointer; font-weight: 700;
    }
    button.secondary { background: #666; }
    button.danger { background: #b00020; }
    .controls { display: flex; gap: 10px; justify-content: center; margin-top: 8px; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <div class="app">
    <h1>Study Timer</h1>
    <div class="phase" id="phase">Choose a study time</div>
    <div class="timer" id="timer">00:00</div>

    <div class="section" id="studySection">
      <div class="section-title">Study (minutes)</div>
      <div class="buttons" id="studyButtons"></div>
    </div>

    <div class="section hidden" id="breakSection">
      <div class="section-title">Break (minutes)</div>
      <div class="buttons" id="breakButtons"></div>
    </div>

    <div class="controls">
      <button class="secondary" id="pauseBtn">Pause</button>
      <button class="secondary hidden" id="muteBtn">Mute</button>
      <button class="danger" id="resetBtn">Reset</button>
    </div>
  </div>

  <!-- YouTube players (hidden) -->
  <div id="studyPlayer" style="display:none"></div>
  <div id="breakPlayer" style="display:none"></div>
  <script src="https://www.youtube.com/iframe_api"></script>

  <script>
    // Options
    const studyTimes = [5,10,15,20,25,30,45];
    const breakTimes = [2,3,5,8,10,15];
    const colors = ['#ff9ecf', '#b57cff', '#7ed957', '#6ecbff'];

    // State
    let intervalId = null;
    let remainingSeconds = 0;
    let currentStudyMinutes = null;
    let phase = 'idle';
    let colorIndex = 0;
    let isMuted = false;

    // Elements
    const timerEl = document.getElementById('timer');
    const phaseEl = document.getElementById('phase');
    const studySection = document.getElementById('studySection');
    const breakSection = document.getElementById('breakSection');
    const studyButtonsEl = document.getElementById('studyButtons');
    const breakButtonsEl = document.getElementById('breakButtons');
    const pauseBtn = document.getElementById('pauseBtn');
    const resetBtn = document.getElementById('resetBtn');
    const muteBtn = document.getElementById('muteBtn');

    // YouTube players
    let studyPlayer = null;
    let breakPlayer = null;

    function formatTime(sec){ const m=Math.floor(sec/60), s=sec%60; return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`; }
    function setBg(){ document.body.style.backgroundColor = colors[colorIndex]; colorIndex=(colorIndex+1)%colors.length; }

    function playStudyAudio(){ if(!studyPlayer) return; breakPlayer && breakPlayer.pauseVideo(); studyPlayer.playVideo(); isMuted?studyPlayer.mute():studyPlayer.unMute(); muteBtn.classList.remove('hidden'); }
    function playBreakAudio(){ if(!breakPlayer) return; studyPlayer && studyPlayer.pauseVideo(); breakPlayer.playVideo(); muteBtn.classList.add('hidden'); }

    function startTimer(seconds, newPhase){
      clearInterval(intervalId);
      remainingSeconds = seconds; phase = newPhase; timerEl.textContent = formatTime(remainingSeconds);
      if(phase==='study'){ phaseEl.textContent='Studying'; setBg(); playStudyAudio(); }
      else { phaseEl.textContent='Break time'; document.body.style.backgroundColor='#f5f5f5'; playBreakAudio(); }
      intervalId = setInterval(()=>{
        remainingSeconds--; timerEl.textContent = formatTime(remainingSeconds);
        if(remainingSeconds<=0){ clearInterval(intervalId); intervalId=null; if(phase==='study'){ breakSection.classList.remove('hidden'); phaseEl.textContent='Choose a break time'; playBreakAudio(); } else { startTimer(currentStudyMinutes*60,'study'); } }
      },1000);
    }

    // Build buttons
    studyTimes.forEach(min=>{ const b=document.createElement('button'); b.textContent=`${min} min`; b.onclick=()=>{ currentStudyMinutes=min; studySection.classList.add('hidden'); breakSection.classList.remove('hidden'); phaseEl.textContent='Choose a break time'; timerEl.textContent=formatTime(min*60); }; studyButtonsEl.appendChild(b); });
    breakTimes.forEach(min=>{ const b=document.createElement('button'); b.textContent=`${min} min`; b.onclick=()=>{ breakSection.classList.add('hidden'); startTimer(currentStudyMinutes*60,'study'); }; breakButtonsEl.appendChild(b); });

    pauseBtn.onclick=()=>{
      if(phase==='idle') return;
      if(intervalId){ clearInterval(intervalId); intervalId=null; pauseBtn.textContent='Resume'; studyPlayer&&studyPlayer.pauseVideo(); breakPlayer&&breakPlayer.pauseVideo(); }
      else { pauseBtn.textContent='Pause'; intervalId=setInterval(()=>{
        remainingSeconds--; timerEl.textContent=formatTime(remainingSeconds);
        if(remainingSeconds<=0){ clearInterval(intervalId); intervalId=null; if(phase==='study'){ breakSection.classList.remove('hidden'); phaseEl.textContent='Choose a break time'; playBreakAudio(); } else { startTimer(currentStudyMinutes*60,'study'); } }
      },1000); phase==='study'?playStudyAudio():playBreakAudio(); }
    };

    resetBtn.onclick=()=>{
      clearInterval(intervalId); intervalId=null; phase='idle'; currentStudyMinutes=null;
      studySection.classList.remove('hidden'); breakSection.classList.add('hidden');
      phaseEl.textContent='Choose a study time'; timerEl.textContent='00:00'; document.body.style.backgroundColor='#ffffff'; pauseBtn.textContent='Pause'; muteBtn.classList.add('hidden');
      studyPlayer&&studyPlayer.pauseVideo(); breakPlayer&&breakPlayer.pauseVideo();
    };

    muteBtn.onclick=()=>{ isMuted=!isMuted; muteBtn.textContent=isMuted?'Unmute':'Mute'; if(studyPlayer){ isMuted?studyPlayer.mute():studyPlayer.unMute(); } };

    // YouTube API
    function onYouTubeIframeAPIReady(){
      studyPlayer = new YT.Player('studyPlayer',{ videoId:'6d8CbHqXD9Y', playerVars:{ autoplay:0, loop:1, playlist:'6d8CbHqXD9Y' }});
      breakPlayer = new YT.Player('breakPlayer',{ videoId:'LH0xb6g0o_k', playerVars:{ autoplay:0, loop:1, playlist:'LH0xb6g0o_k' }});
    }
  </script>
</body>
</html>
